#!/usr/bin/env bash
# Script to install and configure Nginx for redirection
# Nginx should be listening on port 80 and redirect /redirect_me to another page

# Update the package list to ensure we have the latest package information
sudo apt-get update

# Install Nginx using the apt-get command with -y option to automatically confirm installation
sudo apt-get install -y nginx

# Create a configuration file for the redirection
echo "server {
    listen 80;
    server_name chatec.tech;

    location /redirect_me {
        return 301 https://www.youtube.com/watch?v=QH2-TGUlwu4;
    }

}" | sudo tee /etc/nginx/sites-available/redirect_me > /dev/null

# Create a symbolic link to enable the site
sudo ln -s /etc/nginx/sites-available/redirect_me /etc/nginx/sites-enabled/

# Test Nginx configuration for syntax errors
sudo nginx -t

# Restart Nginx to apply the changes
sudo service nginx restart

# Exit with a success message
echo "Nginx redirection configured successfully!"
